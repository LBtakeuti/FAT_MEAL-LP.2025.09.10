---
name: clean-code
description: コード生成・レビュー・エラー修正を自動化するスキル。コード生成時に自動適用し、クリーンで保守性の高いコードを出力する。セキュリティ、パフォーマンス、グローバルなコーディング規約を遵守。エラー発生時は原因分析と自己完結的な修正を行い、同じエラーを繰り返さない。使用タイミング：(1) コード生成時、(2) コードレビュー依頼時、(3) エラー修正時、(4)「コードを書いて」「実装して」等のリクエスト時
---

# Clean Code スキル

コード生成時に自動適用し、品質の高いコードを出力するためのスキル。

## コード生成の原則

### 1. 簡潔性（KISS）
- 1関数1責務（Single Responsibility）
- 関数は20行以内を目安
- ネストは3階層まで
- 早期リターンでネストを減らす

### 2. 命名規則
- 変数・関数名は意図を明確に（`data` → `userProfile`）
- 略語を避ける（`usr` → `user`）
- 一貫した命名規則（言語のスタイルガイドに準拠）

### 3. セキュリティ
- 入力値は常に検証・サニタイズ
- 機密情報はハードコードしない
- SQLインジェクション・XSS対策を実装
- 最小権限の原則

### 4. パフォーマンス
- 不要なループ・計算を避ける
- 適切なデータ構造を選択
- N+1問題を回避
- 遅延読み込みを活用

## エラー修正ワークフロー

エラー発生時は以下の手順で対応：

1. **エラー分類** - 構文/実行時/論理エラーを特定
2. **根本原因分析** - スタックトレースから原因を特定
3. **修正案提示** - 最小限の変更で修正
4. **再発防止** - 同パターンのエラーを記憶し、以降のコード生成に反映

### エラーパターンの記憶

修正したエラーは会話内で記憶し、同じパターンを繰り返さない：
- 型エラー → 型チェックを追加して生成
- Null参照 → Null安全なコードを生成
- インデックス範囲外 → 境界チェックを追加

詳細なエラーパターンは [references/error-patterns.md](references/error-patterns.md) を参照。

## コードレビュー時のチェックリスト

レビュー依頼時は以下を確認し、問題点のみ簡潔に報告：

- [ ] 関数が単一責務か
- [ ] 命名は明確か
- [ ] セキュリティリスクはないか
- [ ] パフォーマンス問題はないか
- [ ] エッジケースは処理されているか
- [ ] 重複コードはないか

詳細なコーディング原則は [references/coding-principles.md](references/coding-principles.md) を参照。

## 出力形式

修正・レビュー結果は簡潔に：

```
【問題】簡潔な問題説明
【原因】根本原因
【修正】変更箇所のみのコード
```

冗長な説明は避け、必要な情報のみ出力する。
